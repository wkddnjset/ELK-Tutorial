# Docker Compose 사용하기

## Docker Compose 란?
- 도커는 여러개의 컨테이너로 서버 환경을 쉽게 설정해주는 기술 중 하나입니다. 여러개의 컨테이너를 실행할 경우 `docker run`이라는 명령어를 사용해서 각각의 컨테이너를 실행하는 것이 매우 비효율적인 작업이여서 `Docker Compose`는 Compose 파일을 실행하는 것 만으로 컨테이너들을 실행, 상속 시켜주는 기능입니다.

### VM 생성 후 Docker 설치

기존 툴박스에서 환경세팅을 하는 과정에서 문제가 발생해서, VM에 우분투 미니멀버전을 올리고 Docker를 설치해서 사용했습니다.

- [우분투 미니멀 설치 링크](https://help.ubuntu.com/community/Installation/MinimalCD)
- [How to install ubuntu minimal](https://www.techrepublic.com/article/how-to-install-ubuntu-minimal-server/)
> `영어`로 설치해주세요. 디스크를 사용해 설치하셨으면 디스크를 삭제하고 실행시켜야 합니다.

- [도커 설치](https://docs.docker.com/install/linux/docker-ce/ubuntu/#install-docker-ce-1)
```bash
$ sudo apt-get update
$ sudo apt-get docker-ce
```

### Elastic Kibana Compose

```yml
version: '2.2'
services:
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:6.4.0
    container_name: elasticsearch
    environment:
      - cluster.name=rogue-one      
      - bootstrap.memory_lock=true
      - "ES_JAVA_OPTS=-Xms1024m -Xmx1024m"
    ulimits:
      memlock:
        soft: -1
        hard: -1
    ports:
      - 9200:9200
    volumes:
      - /Users/wk64/Desktop/docker/elk/elk-data:/usr/share/elasticsearch/data
    networks:
      - esn
  kibana:
    image: docker.elastic.co/kibana/kibana:6.3.2
    container_name: kibana
    ports:
      - 5601:5601
    networks:
      - esn
    depends_on:
      - elasticsearch
  
networks:
  esn:
```